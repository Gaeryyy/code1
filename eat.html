<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ˜Ÿéœ²è°·ç¾é£ŸæŠ½é€‰æœº</title>
    <style>
        :root {
            --sv-border: #5d2c28; 
            --sv-bg: #fcf1cc;    
            --sv-panel: #e1b878;  
            --sv-text: #4b2522;
            --sv-button: #b15d32;
        }

        body {
            background-color: #333; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: "Microsoft YaHei", sans-serif;
            overflow: hidden;
        }

        /* éŸ³ä¹çŠ¶æ€æŒ‡ç¤º */
        #music-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--sv-panel);
            border: 3px solid var(--sv-border);
            padding: 8px 15px;
            font-size: 14px;
            color: var(--sv-text);
            box-shadow: 4px 4px 0 rgba(0,0,0,0.3);
            pointer-events: none; /* ä»…ä½œæ˜¾ç¤ºç”¨ */
        }

        .header {
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #fff;
            font-size: 32px;
            text-shadow: 3px 3px 0 var(--sv-border);
            margin: 0;
        }

        /* æ ¸å¿ƒå±•ç¤ºæ–¹æ¡† */
        .display-box {
            width: 280px;
            height: 300px;
            background-color: var(--sv-bg);
            border: 8px solid var(--sv-border);
            outline: 6px solid var(--sv-panel);
            outline-offset: -14px;
            box-shadow: 12px 12px 0 rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        #food-img {
            width: 150px;
            height: 150px;
            image-rendering: pixelated; 
            z-index: 2;
        }

        .name-tag {
            margin-top: 20px;
            color: var(--sv-text);
            font-weight: bold;
            font-size: 22px;
            text-shadow: 1px 1px 0px #fff;
            z-index: 2;
        }

        .draw-btn {
            margin-top: 50px;
            padding: 15px 60px;
            background-color: var(--sv-button);
            color: white;
            border: 5px solid var(--sv-border);
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 6px 6px 0px #000;
            transition: all 0.1s;
        }

        .draw-btn:hover { background-color: #c96b3a; }
        .draw-btn:active {
            transform: translate(3px, 3px);
            box-shadow: 3px 3px 0px #000;
        }
        .draw-btn:disabled {
            background-color: #888;
            cursor: not-allowed;
            box-shadow: 2px 2px 0px #000;
            transform: translate(2px, 2px);
        }

        /* è·³åŠ¨åŠ¨ç”»ï¼šé™åˆ¶ 5 æ¬¡å¹¶åœåœ¨ç»ˆç‚¹ */
        .bouncing {
            animation: bounce 0.6s ease-in-out 5; 
            animation-fill-mode: forwards; 
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }

        .sparkle {
            position: absolute;
            color: #fff;
            font-size: 24px;
            pointer-events: none;
            z-index: 3;
            animation: fadeOut 0.8s forwards;
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(2.5); }
        }
    </style>
</head>
<body>

    <audio id="bgm" loop>
        <source src="bgm.mp3" type="audio/mpeg">
    </audio>

    <div id="music-status">ğŸ”‡ å¾…æœºä¸­</div>

    <div class="header">
        <h1>ğŸŒŸ å¹¸è¿ç¾é£Ÿæœº ğŸŒŸ</h1>
        <p style="color: #aaa; margin-top: 10px; letter-spacing: 2px;">PRESS START TO EAT</p>
    </div>

    <div class="display-box" id="luck-box">
        <img src="food1.jpg" id="food-img" class="bouncing" alt="ç¾é£Ÿ">
        <div class="name-tag" id="food-name">å‡†å¤‡å¥½äº†å—ï¼Ÿ</div>
    </div>

    <button class="draw-btn" id="start-btn">å†³å®šå§ï¼</button>
<div style="display:none;">
    <script>
        for (let i = 1; i <= 16; i++) {
            new Image().src = `food${i}.jpg`;
        }
    </script>
</div>

<script>
 const foods = [
        "ä¸‰æ˜æ²»", "è¶Šå—æ²³ç²‰", "çª‘é¸¡", "è¢è®°äº‘é¥º", 
        "éº»è¾£çƒ«", "æ¸…ç‚–é¸¡", "æ²™å¿é¸¡è…¿é¥­", "èµ›ç™¾å‘³",
        "æ²™æ‹‰", "çƒ§è…Šé¥­", "ä¾¿åˆ©åº—å…³ä¸œç…®", "éŸ©å¼æ‹Œé¥­",
        "æ¿çƒ§é¸¡è…¿å ¡", "åŒå±‚å‰å£«å ¡", "ç‰›æ’æ„é¢", "ä¸­å¼å®¶å¸¸èœ"
    ];
    const foodImg = document.getElementById('food-img');
    const foodName = document.getElementById('food-name');
    const startBtn = document.getElementById('start-btn');
    const luckBox = document.getElementById('luck-box');
    const bgm = document.getElementById('bgm');
    const musicStatus = document.getElementById('music-status');

    let isRolling = false;

    // å®¹é”™å¤„ç†
    foodImg.onerror = function() {
        this.src = 'https://via.placeholder.com/150/e1b878/4b2522?text=PIXEL+FOOD';
    };

    startBtn.addEventListener('click', () => {
        if (isRolling) return;
        
        isRolling = true;
        startBtn.disabled = true;
        
        // 1. è”åŠ¨ï¼šç‚¹å‡»ç¬é—´éŸ³ä¹å“èµ·ï¼Œä»å¤´æ’­æ”¾
        bgm.currentTime = 0;
        bgm.play().catch(e => console.log("è¯·ç¡®ä¿bgm.mp3è·¯å¾„æ­£ç¡®ï¼Œä¸”ç”¨æˆ·å·²ä¸é¡µé¢äº¤äº’ã€‚"));
        musicStatus.innerText = 'ğŸ”Š æ­£åœ¨æŠ½å–...';

        // 2. ç§»é™¤æ—§çš„è·³åŠ¨åŠ¨ç”»
        foodImg.classList.remove('bouncing'); 

        let step = 0;
        let totalSteps = 40 + Math.floor(Math.random() * 20); 
        let currentSpeed = 50; 

        function roll() {
            step++;
            // ä¿®æ”¹ roll å‡½æ•°é‡Œçš„è¿™ä¸€è¡Œ
const randomIndex = Math.floor(Math.random() * foods.length);
foodImg.src = `food${randomIndex + 1}.jpg?t=${new Date().getTime()}`; // åŠ ä¸ªæ—¶é—´æˆ³å¼ºåˆ¶åˆ·æ–°
            foodName.innerText = foods[randomIndex];

            if (step < totalSteps) {
                if (step > totalSteps - 12) currentSpeed += 35; 
                setTimeout(roll, currentSpeed);
            } else {
                finishDraw();
            }
        }
        roll();
    });

    function finishDraw() {
        isRolling = false;
        startBtn.disabled = false;

        // 3. è”åŠ¨ï¼šè½å®šæ—¶éŸ³ä¹è‡ªåŠ¨æš‚åœ
        bgm.pause();
        musicStatus.innerText = 'ğŸ”‡ æŠ½é€‰å®Œæˆ';

        // 4. è§¦å‘é‡ç»˜å¹¶åŠ ä¸Šè·³åŠ¨ 5 ä¸‹çš„åŠ¨ç”»
        void foodImg.offsetWidth; 
        foodImg.classList.add('bouncing'); 
        
        // 5. æ’’èŠ±åº†ç¥
        for(let i=0; i<10; i++) {
            setTimeout(createSparkle, i * 50);
        }
    }

    function createSparkle() {
        const s = document.createElement('div');
        s.className = 'sparkle';
        s.innerHTML = 'âœ¨';
        s.style.left = Math.random() * 80 + 10 + '%';
        s.style.top = Math.random() * 80 + 10 + '%';
        luckBox.appendChild(s);
        setTimeout(() => s.remove(), 800);
    }
</script>

</body>
</html>